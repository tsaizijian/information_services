# 身心障礙照護紀錄系統 專題報告

## 專案概述

### 專案名稱

身心障礙照護紀錄系統（Information Services for Care Management）

### 開發目的

本系統旨在協助照護機構的照顧者記錄與管理身心障礙人士的日常照護資料，提供完整的健康與照護追蹤功能，提升照護品質與效率。

### 開發日期

2024-2025 年

---

## 系統架構

### 技術棧

#### 前端框架

- **Nuxt 3** (v3.19.2) - Vue 3 的服務端渲染框架
- **Vue 3** (v3.5.22) - 漸進式 JavaScript 框架
- **TypeScript** - 提供類型安全的開發體驗

#### UI 框架與樣式

- **PrimeVue** (v4.3.9) - 豐富的 UI 元件庫
- **Tailwind CSS** (v6.14.0) - 實用優先的 CSS 框架
- **PrimeIcons** - 圖示庫

#### 後端服務

- **Firebase Authentication** - 使用者身份驗證
- **Firebase Firestore** - NoSQL 雲端資料庫
- **Firebase Storage** - 檔案儲存服務
- **VueFire** (v3.2.2) - Firebase 與 Vue 3 的整合工具

#### 資料處理與匯出

- **Day.js** (v1.11.19) - 輕量級日期處理庫
- **XLSX** (v0.18.5) - Excel 檔案生成與解析
- **jsPDF** (v3.0.3) - PDF 文件生成
- **jsPDF-AutoTable** (v5.0.2) - PDF 表格生成
- **DOCX** (v9.5.1) - Word 文件生成
- **File-Saver** (v2.0.5) - 檔案下載

#### 資料視覺化

- **Chart.js** (v4.5.1) - JavaScript 圖表庫
- **vue-chartjs** (v5.3.3) - Chart.js 的 Vue 3 包裝器

---

## 系統功能

### 1. 使用者管理與權限控制

#### 角色定義

系統目前支援兩種使用者角色，各有不同的權限：

##### 管理員 (Admin)

- 新增/編輯/刪除照顧者帳號
- 新增/編輯/刪除個案資料
- 管理班級/組別資料
- 查看所有紀錄
- 系統設定與維護

##### 照顧者/照服員 (Caregiver)

- 新增照護紀錄
- 查看所屬班級個案紀錄
- 編輯自己的紀錄
- 釘選重要紀錄
- 匯出報表（生命徵象紀錄表等）

#### 認證機制

- 電子郵件/密碼登入
- 註冊新帳號（預設為照顧者角色）
- 密碼重設功能
- 電子郵件驗證

### 2. 個案管理

#### 個案基本資料

- 姓名、性別
- 出生日期與年齡計算
- 所屬班級
- 聯絡人資訊（監護人、緊急聯絡人）
- 地址

#### 醫療資訊

- 病史記錄
- 特殊需求
- 備註欄位

### 3. 班級管理

- 班級建立與編輯
- 班級描述與說明
- 負責照顧者指派
- 個案分配至班級
- 建立與更新時間戳記

### 4. 照護紀錄系統

#### 生命徵象記錄 ⭐ 核心功能

##### 月度生命徵象追蹤

- 體重（公斤）
- 血壓（收縮壓/舒張壓 mmHg）
- 脈搏（次/分鐘）
- 血氧濃度（%）
- 測量者資訊
- 測量日期
- 備註說明

##### 資料視覺化

- 年度 12 個月趨勢圖表
- 多項指標同時顯示
- 異常值標記與提醒

#### 醫療照護專項記錄

##### 腸道狀況記錄

- 排便時間與頻率
- 解便量（少量、中等、大量）
- 顏色記錄（正常黃褐色、深色/黑色、淺色/灰白、綠色、帶血）
- 特殊狀況記錄（水便、硬塊、黏液、惡臭、排便困難等）
- 伴隨症狀（腹痛、嘔吐、發燒、食慾差等）
- 是否使用軟便劑或灌腸
- 處理方式與備註

> **註**：目前未使用布里斯托大便分類法（Bristol Stool Scale），採用簡化的量與狀況描述。

##### 情緒記錄

- 情緒狀態評估
- 行為觀察
- 觸發因素分析
- 處理措施
- 效果評估

##### 月經週期記錄（女性個案）

- 開始與結束日期
- 週期天數
- 經血量評估
- 疼痛程度
- 不適症狀
- 處理措施

##### 癲癇發作記錄

- 發作時間與持續時間
- 發作類型分類
- 嚴重程度評估
- 觸發因素
- 處理措施
- 後續觀察

### 5. 紀錄管理功能

#### 釘選功能

- 重要紀錄標記
- 快速查看釘選內容
- 取消釘選

#### 交班功能

- 班次交接紀錄
- 重要事項交代
- 待辦事項追蹤

#### 家屬聯絡記錄

- 聯絡日期與時間
- 聯絡方式
- 聯絡內容
- 回應記錄

### 6. 資料匯出功能

系統提供多種格式的資料匯出：

#### Excel 格式 (.xlsx)

- 生命徵象紀錄表
- 個案清單
- 照護紀錄彙總

#### PDF 格式 (.pdf)

- 正式報表輸出
- 適合列印歸檔

#### Word 格式 (.docx)

- 可編輯文件格式
- 適合進一步編輯

---

## 資料庫設計

### Firestore 集合架構

#### users 集合（使用者）

```typescript
{
  id: string,              // 文件 ID（同 Firebase Auth UID）
  email: string,           // 電子郵件
  displayName: string,     // 顯示名稱
  phone: string,          // 聯絡電話
  role: string,           // 角色：admin | caregiver
  isActive: boolean,      // 帳號狀態
  createdAt: Timestamp,   // 建立時間
  updatedAt: Timestamp,   // 更新時間
  avatar: string,         // 頭像 URL（選填，功能尚未實作）
  department: string      // 部門（選填）
}
```

#### classes 集合（班級）

```typescript
{
  id: string,              // 文件 ID
  name: string,            // 班級名稱
  description: string,     // 班級描述
  instructorIds: string[], // 負責照顧者 ID 陣列
  createdAt: Timestamp,    // 建立時間
  updatedAt: Timestamp     // 更新時間
}
```

#### clients 集合（個案）

```typescript
{
  id: string,              // 文件 ID
  name: string,            // 姓名
  nickname: string,        // 暱稱
  gender: string,          // 性別：male | female | other
  birthDate: Timestamp,    // 出生日期
  photoUrl: string,        // 照片 URL（欄位保留，功能尚未實作）
  classId: string,         // 所屬班級 ID
  guardianName: string,    // 監護人姓名
  guardianPhone: string,   // 監護人電話
  emergencyContact: string, // 緊急聯絡人
  emergencyPhone: string,  // 緊急聯絡電話
  address: string,         // 住址
  medicalHistory: string,  // 病史
  allergies: string,       // 過敏史
  medications: string,     // 用藥
  specialNeeds: string,    // 特殊需求
  notes: string,          // 備註
  isActive: boolean,      // 在案狀態
  createdAt: Timestamp,   // 建立時間
  updatedAt: Timestamp    // 更新時間
}
```

#### monthlyVitalSigns 集合（月度生命徵象）

```typescript
{
  id: string,              // 文件 ID
  clientId: string,        // 個案 ID
  clientName: string,      // 個案姓名
  year: number,           // 年份
  month: number,          // 月份（1-12）
  weight: number,         // 體重（kg）
  bloodPressure: string,  // 血壓（格式：120/80）
  pulse: number,          // 脈搏（次/分）
  bloodOxygen: number,    // 血氧濃度（%）
  measuredBy: string,     // 測量者 ID
  measuredByName: string, // 測量者姓名
  measuredDate: Timestamp, // 測量日期
  notes: string,          // 備註
  createdAt: Timestamp,   // 建立時間
  updatedAt: Timestamp    // 更新時間
}
```

#### vitalSignRecords 集合（詳細生命徵象紀錄）

> **註**：此集合為進階功能規劃，目前前端僅使用 monthlyVitalSigns 集合。
> 資料庫結構已預留以下欄位供未來擴展使用：

包含月度紀錄的所有欄位，另外新增：

- temperature（體溫，功能尚未實作）
- bloodSugar（血糖，功能尚未實作）
- systolicBP（收縮壓）
- diastolicBP（舒張壓）

#### bowelRecords 集合（腸道紀錄）

#### emotionRecords 集合（情緒紀錄）

#### menstrualRecords 集合（月經紀錄）

#### seizureRecords 集合（癲癇紀錄）

#### handoverRecords 集合（交班紀錄）

#### familyContactRecords 集合（家屬聯絡紀錄）

> **註**：家屬聯絡紀錄功能仍保留，用於記錄與個案家屬的溝通內容。

### 資料庫索引設計

系統已配置適當的複合索引以優化查詢效能：

- 個案 ID + 年份查詢
- 個案 ID + 日期範圍查詢
- 班級 ID + 時間排序

---

## 安全性設計

### Firebase Security Rules

#### Firestore 安全規則

- 基於角色的存取控制（RBAC）
- 使用者必須登入才能存取資料
- 管理員擁有完整權限
- 照顧者可管理個案與紀錄
- 防止未授權的資料存取

#### Storage 安全規則

> **註**：圖片上傳功能尚未實作，以下為規劃中的安全規則：

- 上傳檔案需經過驗證
- 限制檔案大小與類型
- 圖片檔案大小限制為 5MB
- 僅允許圖片格式上傳

### 前端路由保護

#### 認證中介層 (auth.ts)

- 檢查使用者登入狀態
- 未登入自動導向登入頁面
- 已登入使用者無法訪問登入頁面

#### 角色權限中介層 (role.ts)

- 檢查使用者角色權限
- 保護管理功能頁面
- 防止權限提升攻擊

---

## 程式架構

### Composables 設計模式

系統採用 Vue 3 Composition API，將業務邏輯封裝為可重用的 Composables：

#### useAuth.ts - 認證管理

提供完整的身份驗證功能：

```typescript
- register(): 使用者註冊
- login(): 使用者登入
- logout(): 登出
- resetPassword(): 密碼重設
- initAuth(): 初始化認證狀態
- isAdmin(): 檢查管理員權限
- isCaregiver(): 檢查照顧者權限
- hasRole(): 檢查特定角色
```

#### useFirestore.ts - 資料庫操作

封裝 Firestore 的 CRUD 操作：

```typescript
- queryDocuments(): 查詢文件
- getDocument(): 取得單一文件
- addDocument(): 新增文件
- updateDocument(): 更新文件
- deleteDocument(): 刪除文件
```

#### useClients.ts - 個案管理

處理個案相關的所有操作：

```typescript
- getClients(): 取得個案清單
- getClient(): 取得單一個案
- createClient(): 建立個案
- updateClient(): 更新個案
- deleteClient(): 刪除個案
- getClientsByClass(): 依班級查詢個案
```

#### useClasses.ts - 班級管理

管理班級資料：

```typescript
- getClasses(): 取得班級清單
- getClass(): 取得單一班級
- createClass(): 建立班級
- updateClass(): 更新班級
- deleteClass(): 刪除班級
```

#### useVitalSigns.ts - 生命徵象管理

生命徵象紀錄的核心功能：

```typescript
- getYearlyVitalSigns(): 取得年度12個月資料
- saveMonthlyVitalSign(): 儲存月度紀錄
- getVitalSignTrends(): 取得趨勢資料
- getRecentVitalSigns(): 取得最近紀錄
- searchVitalSigns(): 搜尋紀錄
```

#### useRecords.ts - 照護紀錄管理

通用照護紀錄功能：

```typescript
- getRecords(): 取得紀錄清單
- createRecord(): 建立紀錄
- updateRecord(): 更新紀錄
- deleteRecord(): 刪除紀錄
- togglePin(): 切換釘選狀態
- getPinnedRecords(): 取得釘選紀錄
```

#### useExport.ts - 資料匯出

多格式資料匯出功能：

```typescript
- exportToExcel(): 匯出 Excel
- exportToPDF(): 匯出 PDF
- exportToWord(): 匯出 Word
- exportVitalSignsTable(): 匯出生命徵象表
```

### 頁面路由架構

```
/                          首頁
/login                     登入頁面
/register                  註冊頁面
/forgot-password           忘記密碼
/dashboard                 儀表板（需登入）
/profile                   個人資料（需登入）
/users                     使用者管理（需管理員權限）
/classes                   班級管理（需登入）
/clients                   個案管理（需登入）
/clients/[id]              個案詳細資料（需登入）
/vital-signs               生命徵象管理（需登入）
/medical-care              醫療照護選單（需登入）
  /medical-care/bowel      腸道紀錄（需登入）
  /medical-care/emotion    情緒紀錄（需登入）
  /medical-care/menstrual  月經紀錄（需登入）
  /medical-care/seizure    癲癇紀錄（需登入）
/records                   照護紀錄（需登入）
/handover                  交班紀錄（需登入）
/parent-contact            家屬聯絡（需登入）
```

---

## 開發與部署

### 開發環境設置

#### 環境變數配置

需要在 `frontend/.env` 設定以下 Firebase 環境變數：

```env
NUXT_PUBLIC_FIREBASE_API_KEY=your_api_key
NUXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_auth_domain
NUXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NUXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_storage_bucket
NUXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NUXT_PUBLIC_FIREBASE_APP_ID=your_app_id
NUXT_PUBLIC_FIREBASE_MEASUREMENT_ID=your_measurement_id
```

#### 套件管理

使用 pnpm 作為套件管理器：

```bash
# 安裝依賴
pnpm install

# 開發伺服器
pnpm dev

# 建置生產版本
pnpm build

# 預覽生產版本
pnpm preview
```

### Firebase 部署

#### 初始化 Firebase

```bash
firebase login
firebase init
```

#### 部署 Firestore 規則與索引

```bash
firebase deploy --only firestore
```

#### 部署 Storage 規則

```bash
firebase deploy --only storage
```

### 前端部署選項

#### Vercel 部署（推薦）

- 自動化 CI/CD
- 全球 CDN 加速
- 零配置部署
- 自動 HTTPS

#### Firebase Hosting

```bash
firebase deploy --only hosting
```

---

## 系統特色與優勢

### 1. 雲端化架構

- 無需自建伺服器
- 自動備份與災難恢復
- 隨處可存取
- 多裝置同步

### 2. 即時資料更新

- Firebase Realtime 技術
- 多人協作無衝突
- 即時看到最新資料

### 3. 安全性保障

- 企業級安全規則
- 角色權限分離
- 資料加密傳輸
- 審計追蹤記錄

### 4. 使用者友善介面

- 現代化 UI 設計
- 響應式佈局（支援手機、平板、電腦）
- 直覺式操作流程
- 完善的錯誤提示

### 5. 資料視覺化

- 圖表呈現趨勢
- 一目了然的健康狀態
- 異常值快速識別

### 6. 彈性的匯出功能

- 多種格式選擇
- 自訂欄位與範圍
- 適合不同用途

---

## 未來擴展規劃

### 短期目標

1. 推播通知功能

   - 重要事件提醒
   - 用藥時間通知
   - 異常值警報

2. 行動應用程式

   - iOS/Android APP
   - 離線資料存取
   - 相機整合

3. 報表模板系統
   - 預設報表樣式
   - 自訂報表欄位
   - 排程匯出

### 中期目標

1. AI 輔助分析

   - 健康趨勢預測
   - 異常模式偵測
   - 智慧建議系統

2. 藥物管理模組

   - 用藥提醒
   - 藥物交互作用檢查
   - 藥物庫存管理

3. 多語言支援
   - 英文介面
   - 其他語言擴展

### 長期目標

1. 整合醫療資訊系統

   - 與醫院系統對接
   - 電子病歷整合
   - 遠距醫療支援

2. 大數據分析平台

   - 跨機構資料分析
   - 照護品質指標
   - 研究資料支援

3. 智慧穿戴裝置整合
   - 自動記錄生命徵象
   - 即時健康監測
   - 緊急事件偵測

---

## 技術挑戰與解決方案

### 挑戰 1：資料安全性

**問題**：處理敏感的個人健康資料
**解決方案**：

- 實作嚴格的 Firebase Security Rules
- 使用 HTTPS 加密傳輸
- 實施角色權限控管
- 定期安全審計

### 挑戰 2：資料一致性

**問題**：多人同時編輯可能產生衝突
**解決方案**：

- 使用 Firestore 的交易功能
- 實作樂觀鎖定機制
- 提供衝突解決介面
- 記錄完整的修改歷史

### 挑戰 3：效能優化

**問題**：大量資料載入影響效能
**解決方案**：

- 實作分頁載入
- 使用 Firestore 索引優化查詢
- 前端資料快取
- 延遲載入非關鍵資源

### 挑戰 4：離線使用

**問題**：網路不穩定時的使用體驗
**解決方案**：

- 規劃 Firestore 離線持久化
- 實作本地資料快取
- 提供離線模式提示
- 資料同步衝突處理

---

## 系統測試

### 功能測試

- 使用者註冊與登入流程
- 個案資料 CRUD 操作
- 照護紀錄新增與編輯
- 權限控管驗證
- 資料匯出功能

### 安全性測試

- SQL Injection 防護（NoSQL 特性）
- XSS 攻擊防護
- CSRF 防護
- 權限提升測試
- 資料洩漏檢測

### 效能測試

- 大量資料載入測試
- 並發使用者測試
- 資料庫查詢效能
- 前端渲染效能

### 相容性測試

- 跨瀏覽器測試（Chrome、Firefox、Safari、Edge）
- 響應式設計測試（手機、平板、桌面）
- 不同作業系統測試

---

## 專案管理與文件

### 文件架構

```
ai_docs/
├── PROJECT_PLAN.md           專案規劃文件
├── FIRESTORE_STRUCTURE.md    資料庫結構說明
├── BACKEND_SUMMARY.md        後端設定摘要
├── FIREBASE_SETUP.md         Firebase 部署指南
├── USER_MANAGEMENT.md        使用者管理說明
├── VERCEL_DEPLOYMENT.md      Vercel 部署指南
├── SETUP_COMPLETE.md         設定完成檢查清單
├── BACKEND_CHECKLIST.md      後端檢查清單
└── TODO.md                   待辦事項
```

### 版本控制

- 使用 Git 進行版本控制
- GitHub 作為遠端儲存庫
- 分支策略：main（主分支）
- 定期提交與推送

---

## 結論

本身心障礙照護紀錄系統透過現代化的網頁技術與雲端服務，成功打造出一個安全、穩定、易用的照護管理平台。系統不僅解決了傳統紙本記錄的諸多不便，更透過資料視覺化、智慧匯出等功能，大幅提升照護品質與工作效率。

### 專案成果

✅ 完整的使用者權限管理系統
✅ 多面向照護紀錄功能
✅ 生命徵象追蹤與視覺化
✅ 彈性的資料匯出功能
✅ 企業級安全性設計
✅ 響應式跨裝置支援
✅ 完善的技術文件

### 技術亮點

- 採用最新的 Vue 3 Composition API
- 無伺服器架構（Serverless）
- 即時資料同步
- 模組化程式設計
- TypeScript 類型安全
- 現代化 UI/UX 設計

### 實用價值

本系統能夠有效協助照護機構：

- 提升照護記錄的完整性與準確性
- 減少人工記錄的時間成本
- 快速追蹤個案健康狀態
- 促進團隊間的溝通協作
- 提供數據支持決策
- 符合法規與稽核需求

### 未來展望

隨著技術的進步與使用者需求的演進，本系統將持續優化與擴展，朝向更智慧化、自動化的方向發展，期許能為照護產業帶來更大的價值。

---

## 附錄

### A. 系統需求

#### 使用者端

- 現代網頁瀏覽器（Chrome 90+、Firefox 88+、Safari 14+、Edge 90+）
- 穩定的網路連線
- 建議螢幕解析度：1280x720 以上

#### 開發端

- Node.js 18+ 或 20+
- pnpm 10.15.0+
- Git
- VS Code（建議）
- Firebase CLI

### B. 參考資料

- [Nuxt 3 官方文件](https://nuxt.com/)
- [Vue 3 官方文件](https://vuejs.org/)
- [Firebase 文件](https://firebase.google.com/docs)
- [PrimeVue 文件](https://primevue.org/)
- [Tailwind CSS 文件](https://tailwindcss.com/)

### C. 授權資訊

本專案為學術研究與教育用途開發。

---

**報告撰寫日期**：2024 年 12 月 24 日
**系統版本**：1.0.0
**撰寫者**：GitHub Copilot
